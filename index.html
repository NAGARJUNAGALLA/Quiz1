
<html lang="en">
<head>
<meta charset="UTF-8"></meta>
<meta content="width=device-width, initial-scale=1.0" name="viewport"></meta>
<title>Quiz</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"></link>

<!-- MathJax -->
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] },
  options: { renderActions: { addMenu: [] } },
  startup: { typeset: false }
};
</script>
<script async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
/* (Keep your same CSS ‚Äî unchanged) */
html, body {margin:0;height:100%;overflow:hidden;background:#f8f8f8;font-family:'Segoe UI',sans-serif;}
.quiz-container{position:absolute;top:-40px;bottom:20px;left:-10px;right:0;overflow-y:auto;background:#fff;height:80vh;}
.quiz-header{background-color:#1b4332;background-image:linear-gradient(rgba(255,255,255,0.05)1px,transparent1px),linear-gradient(90deg,rgba(255,255,255,0.05)1px,transparent1px);background-size:20px 20px;color:white;display:flex;justify-content:space-between;align-items:center;padding:15px 20px;font-weight:600;font-size:18px;position:fixed;top:0;left:0;right:0;z-index:10;}
.quiz-body{flex:1;padding:20px 20px 10px;overflow-y:auto;}
.stats{display:flex;justify-content:space-between;flex-wrap:wrap;margin-bottom:10px;color:#333;font-weight:500;}
.toggle-nav-btn{display:block;width:100%;background:#1b4332;color:#fff;border:none;border-radius:6px;padding:8px 0;margin-bottom:8px;font-weight:600;cursor:pointer;transition:background .3s;}
.toggle-nav-btn:hover{background:#14532d;}
.question-nav{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:15px;overflow:hidden;max-height:200px;transition:max-height .3s ease;}
.question-nav.hidden{max-height:0;margin:0;}
.question-nav button{width:36px;height:36px;border-radius:50%;border:1px solid #ccc;background:#f5f5f5;cursor:pointer;font-weight:500;transition:all .2s;}
.question-nav button.active{border:2px solid #1b4332;}
.question-nav button.answered{background:#1b4332;color:#fff;}
#question-container h4{font-size:16px;margin-bottom:8px;color:#333;}
#question-container p{font-size:15px;color:#444;}
.options label{display:block;border:1px solid #ddd;border-radius:8px;padding:10px;margin-bottom:8px;cursor:pointer;transition:all .2s;}
.options label:hover{border-color:#1e3a8a;background:#f0f4ff;}
.correct{border-color:green!important;background:#e8fce8!important;}
.wrong{border-color:red!important;background:#ffe8e8!important;}
.quiz-footer{position:fixed;bottom:0;left:0;right:0;width:100%;display:flex;justify-content:space-between;background-color:#1b4332;background-image:linear-gradient(rgba(255,255,255,0.05)1px,transparent1px),linear-gradient(90deg,rgba(255,255,255,0.05)1px,transparent1px);background-size:20px 20px;border-top:1px solid #ddd;padding:10px;box-shadow:0 -2px 8px rgba(0,0,0,0.1);}
.quiz-footer button{flex:1;background:white;color:#1b4332;border:none;padding:10px;border-radius:25px;font-size:15px;cursor:pointer;transition:.3s;margin:0 5px;}
.quiz-footer button:hover{background:white;}
#result-section{background:#f9f9f9;border-top:2px solid #1e3a8a;padding:15px;margin-top:20px;border-radius:10px;}
#result-section h3{color:#1e3a8a;margin-bottom:10px;}
</style>
</head>

<body>

<!-- USER FORM -->
<div id="user-form" style="margin-top: 80px; text-align: center;">
  <h3>‡∞µ‡∞æ‡∞ï‡±ç‡∞Ø‡∞æ‡∞≤‡±Å ‡∞∞‡∞ï‡∞æ‡∞≤‡±Å </h3>
  <input id="userName" placeholder="Enter your Full name" required="" style="border-radius: 8px; border: 1px solid #ccc; max-width: 300px; padding: 10px; width: 80%;" type="text" />
  <br /><br />
  <button onclick="loadQuiz()" style="background: #1b4332; border-radius: 8px; border: none; color: white; padding: 10px 20px;">
    Start Quiz
  </button>
</div>

<!-- QUIZ AREA -->
<div id="quiz-area" style="display: none;">
<div class="quiz-container">
  <div class="quiz-header">
    <div id="quiz-title">Quiz</div>
    <div>‚è±Ô∏è <span id="timer"></span></div>
    <i class="fa-solid fa-expand full-icon" onclick="toggleFullscreen()" title="Fullscreen"></i>
  </div>
  <div class="quiz-body">
    <div class="stats">
      <span id="answered">Answered: 0</span>
      <span id="not-answered">Not answered: 0</span>
    </div>
    <button class="toggle-nav-btn" onclick="toggleNav()">üîΩ Show/Hide Questions</button>
    <div class="question-nav" id="question-nav"></div>
    <h3 id="quiz-title-text"></h3>
    <div id="question-container"></div>
    <div class="hidden" id="result-section"></div>
  </div>
  <div class="quiz-footer">
    <button onclick="prevQuestion()">Previous</button>
    <button onclick="submitQuiz()">Submit</button>
    <button onclick="nextQuestion()">Next</button>
  </div>
</div>
</div>

<script>
const GOOGLE_SHEET_URL = "https://script.google.com/macros/s/AKfycbzfr2Al0_zoFfMdcT6_fsxOaSDO-a3F9Io5lkkUyl-1ewVZUWIz80nSJRqhqv3QF3KR/exec"; // üîó Replace with your Web App URL
const QUIZ_TITLE = "";

let questions=[], current=0, answers=[], submitted=false, timeLeft=0, timerInterval;

// Load questions from Google Sheets
async function loadQuiz(){
  const name=document.getElementById("userName").value.trim();
  if(!name){alert("Please enter your name first.");return;}
  document.getElementById("user-form").style.display="none";
  document.getElementById("quiz-area").style.display="block";
  document.getElementById("quiz-title-text").textContent=QUIZ_TITLE;
  
  try {
    const res=await fetch(GOOGLE_SHEET_URL);
    questions=await res.json();
    answers=Array(questions.length).fill(null);
    timeLeft=questions.length*60;
    renderNav();renderQuestion();startTimer();
  } catch(err){
    alert("Failed to load questions from Google Sheets");
    console.error(err);
  }
}

function toggleNav(){document.getElementById("question-nav").classList.toggle("hidden");}
function renderNav(){
  const nav=document.getElementById("question-nav");nav.innerHTML="";
  questions.forEach((_,i)=>{
    const b=document.createElement("button");
    b.textContent=i+1;
    b.className=(i===current?"active ":"")+(answers[i]!=null?"answered":"");
    b.onclick=()=>{current=i;renderQuestion();};
    nav.appendChild(b);
  });
  updateStats();
}
function renderQuestion(){
  const q=questions[current];
  const c=document.getElementById("question-container");
  let h=`<h4>Question ${current+1} of ${questions.length}</h4><p>${q.q}</p><div class="options">`;
  q.options.forEach((o,i)=>{
    let cls="";
    if(submitted){
      if(i===q.answerId) cls="correct";
      else if(answers[current]===i && i!==q.answerId) cls="wrong";
    }
    h+=`<label class="${cls}"><input type="radio" name="opt" value="${i}" ${answers[current]===i?'checked':''} ${submitted?'disabled':''} onchange="selectOpt(${i})">${o}</label>`;
  });
  h+="</div>";c.innerHTML=h;renderNav();
  if(window.MathJax&&MathJax.typesetPromise) MathJax.typesetPromise([c]);
}
function selectOpt(i){if(submitted)return;answers[current]=i;renderNav();}
function nextQuestion(){if(current<questions.length-1){current++;renderQuestion();}}
function prevQuestion(){if(current>0){current--;renderQuestion();}}
function updateStats(){
  const a=answers.filter(x=>x!==null).length;
  document.getElementById("answered").textContent="Answered: "+a;
  document.getElementById("not-answered").textContent="Not answered: "+(questions.length-a);
}
function startTimer(){
  updateTimer();timerInterval=setInterval(()=>{timeLeft--;updateTimer();if(timeLeft<=0){clearInterval(timerInterval);submitQuiz();}},1000);
}
function updateTimer(){
  const m=Math.floor(timeLeft/60),s=timeLeft%60;
  document.getElementById("timer").textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}
function submitQuiz(){
  if(submitted)return;submitted=true;clearInterval(timerInterval);
  let correct=0,wrong=0;
  questions.forEach((q,i)=>{if(answers[i]!=null){if(answers[i]===q.answerId)correct++;else wrong++;}});
  const skipped=questions.length-(correct+wrong);
  const total=questions.length;
  const score=Math.round((correct/total)*100);
  const name=document.getElementById("userName").value;
  const html=`<h3>Result Summary</h3>
    <p><b>Name:</b> ${name}</p>
    <p><b>Total Questions:</b> ${total}</p>
    <p><b>Correct:</b> ${correct}</p>
    <p><b>Wrong:</b> ${wrong}</p>
    <p><b>Skipped:</b> ${skipped}</p>
    <p><b>Score:</b> ${score}%</p>`;
  document.getElementById("result-section").innerHTML=html;
  document.getElementById("result-section").classList.remove("hidden");
  renderQuestion();
}
function toggleFullscreen(){
  if(!document.fullscreenElement){document.documentElement.requestFullscreen().catch(e=>alert(e.message));}
  else{document.exitFullscreen();}
}
</script>
</body>
</html>
